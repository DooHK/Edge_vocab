<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì˜ì–´ ë‹¨ì–´ì¥</title>
  <meta name="description" content="ì˜ì–´ ë‹¨ì–´ë¥¼ ë²ˆì—­í•˜ê³  ì €ì¥í•˜ëŠ” ë¬´ë£Œ ë‹¨ì–´ì¥ ì•±" />
  <meta name="theme-color" content="#4A90D9" />

  <!-- PWA -->
  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />

  <!-- OG (ì¹´ì¹´ì˜¤í†¡Â·ë§í¬ ê³µìœ  ì‹œ ë¯¸ë¦¬ë³´ê¸°) -->
  <meta property="og:title"       content="ì˜ì–´ ë‹¨ì–´ì¥" />
  <meta property="og:description" content="ì˜ì–´ ë‹¨ì–´ë¥¼ ë²ˆì—­í•˜ê³  ì €ì¥í•´ í€´ì¦ˆë¡œ ë³µìŠµí•˜ì„¸ìš”" />
  <meta property="og:type"        content="website" />

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --blue:  #4A90D9;
      --green: #34C759;
      --red:   #ff3b30;
      --bg:    #f0f4f8;
      --card:  #ffffff;
      --text:  #222222;
      --sub:   #888888;
      --border:#dde3ea;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: var(--bg);
      color: var(--text);
      font-size: 14px;
      min-width: 280px;
      max-width: 480px;
      margin: 0 auto;
    }

    /* â”€â”€ Header â”€â”€ */
    .header {
      background: linear-gradient(135deg, #4A90D9, #2c6fad);
      color: white;
      padding: 16px 16px 12px;
      text-align: center;
    }
    .header h1 { font-size: 17px; font-weight: 800; letter-spacing: 0.3px; }
    .header p  { font-size: 11px; opacity: 0.75; margin-top: 3px; }

    /* â”€â”€ Install banner â”€â”€ */
    #installBanner {
      display: none;
      align-items: center;
      justify-content: space-between;
      background: #fff8e1;
      padding: 9px 12px;
      font-size: 12px;
      color: #7a5c00;
      border-bottom: 1px solid #ffe082;
      gap: 8px;
    }
    #installBanner button {
      padding: 5px 12px;
      background: #f9a825;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 700;
      cursor: pointer;
      white-space: nowrap;
    }

    /* â”€â”€ Tabs â”€â”€ */
    .tabs {
      display: flex;
      background: var(--card);
      border-bottom: 2px solid var(--border);
      position: sticky;
      top: 0;
      z-index: 10;
    }
    .tab {
      flex: 1;
      padding: 11px 6px;
      text-align: center;
      cursor: pointer;
      font-weight: 700;
      font-size: 12px;
      color: var(--sub);
      transition: color 0.15s;
      user-select: none;
    }
    .tab.active {
      color: var(--blue);
      border-bottom: 2px solid var(--blue);
      margin-bottom: -2px;
    }

    /* â”€â”€ Panels â”€â”€ */
    .panel { padding: 14px; display: none; }
    .panel.active { display: block; }

    /* â”€â”€ Input row â”€â”€ */
    .input-row { display: flex; gap: 8px; margin-bottom: 12px; }
    .input-row input {
      flex: 1;
      padding: 10px 12px;
      border: 1.5px solid var(--border);
      border-radius: 8px;
      font-size: 14px;
      outline: none;
      background: var(--card);
      transition: border-color 0.2s;
    }
    .input-row input:focus { border-color: var(--blue); }
    .input-row input::placeholder { color: #bbb; }

    /* â”€â”€ Buttons â”€â”€ */
    .btn {
      padding: 10px 14px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 700;
      transition: filter 0.15s, opacity 0.15s;
      line-height: 1;
    }
    .btn:active:not(:disabled) { filter: brightness(0.85); }
    .btn:disabled { opacity: 0.45; cursor: not-allowed; }
    .btn-blue  { background: var(--blue);  color: #fff; }
    .btn-green { background: var(--green); color: #fff; width: 100%; margin-top: 10px; }
    .btn-green.added { background: #aaa; }
    .btn-red   { background: var(--red);   color: #fff; }
    .btn-sm    { padding: 5px 10px; font-size: 12px; }

    /* â”€â”€ Loading â”€â”€ */
    .loading { display: none; text-align: center; padding: 20px 0; color: var(--sub); font-size: 13px; }
    .loading.show { display: block; }
    .spinner {
      display: inline-block;
      width: 16px; height: 16px;
      border: 2px solid var(--border);
      border-top-color: var(--blue);
      border-radius: 50%;
      animation: spin 0.7s linear infinite;
      vertical-align: middle;
      margin-right: 6px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* â”€â”€ Result card â”€â”€ */
    .result-card {
      background: var(--card);
      border-radius: 10px;
      padding: 14px 16px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
      display: none;
    }
    .result-card.show { display: block; }
    .result-en   { font-size: 21px; font-weight: 800; word-break: break-word; }
    .result-ko   { font-size: 15px; color: var(--blue); margin-top: 5px; font-weight: 600; }
    .result-meta { font-size: 11px; color: #bbb; margin-top: 6px; }

    /* â”€â”€ Vocab list â”€â”€ */
    .vocab-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    .vocab-count { font-size: 12px; color: var(--sub); font-weight: 600; }

    .search-box {
      width: 100%;
      padding: 8px 12px;
      border: 1.5px solid var(--border);
      border-radius: 8px;
      font-size: 13px;
      outline: none;
      background: var(--card);
      margin-bottom: 10px;
      transition: border-color 0.2s;
    }
    .search-box:focus { border-color: var(--blue); }

    .word-item {
      background: var(--card);
      border-radius: 8px;
      padding: 11px 13px;
      margin-bottom: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 1px 5px rgba(0,0,0,0.06);
    }
    .word-info { flex: 1; overflow: hidden; }
    .word-en-item { font-weight: 700; font-size: 15px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .word-ko-item { color: var(--blue); font-size: 12px; margin-top: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .word-date-item { font-size: 10px; color: #ccc; margin-top: 3px; }
    .word-actions { display: flex; gap: 5px; margin-left: 8px; flex-shrink: 0; }

    .empty-msg {
      text-align: center;
      color: #bbb;
      padding: 40px 0 30px;
      font-size: 13px;
      line-height: 1.9;
    }
    .empty-icon { font-size: 38px; display: block; margin-bottom: 8px; }

    /* â”€â”€ Export button â”€â”€ */
    .export-row { display: flex; gap: 8px; margin-bottom: 12px; }
    .export-row button { flex: 1; }

    /* â”€â”€ Quiz â”€â”€ */
    .quiz-card {
      background: var(--card);
      border-radius: 10px;
      padding: 24px 16px 20px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
      text-align: center;
    }
    .quiz-progress { font-size: 12px; color: #aaa; margin-bottom: 14px; }
    .quiz-progress-bar {
      height: 4px; background: var(--border); border-radius: 2px;
      margin-bottom: 20px; overflow: hidden;
    }
    .quiz-progress-fill { height: 100%; background: var(--blue); border-radius: 2px; transition: width 0.3s; }
    .quiz-word   { font-size: 28px; font-weight: 800; margin-bottom: 6px; }
    .quiz-hint   { font-size: 12px; color: #bbb; margin-bottom: 22px; }
    .quiz-answer { font-size: 18px; font-weight: 700; color: var(--green); min-height: 28px; margin-bottom: 16px; display: none; }
    .quiz-answer.show { display: block; }
    .quiz-btns   { display: flex; gap: 8px; justify-content: center; flex-wrap: wrap; }
    .quiz-empty  { text-align: center; color: #bbb; padding: 40px 0; font-size: 13px; }

    /* â”€â”€ Toast â”€â”€ */
    .toast {
      position: fixed;
      bottom: 18px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(20,20,20,0.88);
      color: #fff;
      padding: 9px 20px;
      border-radius: 20px;
      font-size: 12px;
      opacity: 0;
      transition: opacity 0.25s;
      pointer-events: none;
      white-space: nowrap;
      z-index: 999;
    }
    .toast.show { opacity: 1; }
  </style>
</head>
<body>

  <div class="header">
    <h1>ğŸ“– ì˜ì–´ ë‹¨ì–´ì¥</h1>
    <p>ë²ˆì—­ Â· ì €ì¥ Â· í€´ì¦ˆë¡œ ë‹¨ì–´ë¥¼ ì™¸ì›Œë³´ì„¸ìš”</p>
  </div>

  <!-- PWA ì„¤ì¹˜ ë°°ë„ˆ -->
  <div id="installBanner">
    <span>ğŸ“² ì•±ìœ¼ë¡œ ì„¤ì¹˜í•˜ë©´ ë” í¸ë¦¬í•´ìš”!</span>
    <button onclick="installApp()">ì„¤ì¹˜í•˜ê¸°</button>
  </div>

  <div class="tabs">
    <div class="tab active" onclick="switchTab('translate')">ğŸ” ë²ˆì—­</div>
    <div class="tab"        onclick="switchTab('vocab')">ğŸ“š ë‹¨ì–´ì¥<span id="badge"></span></div>
    <div class="tab"        onclick="switchTab('quiz')">âœï¸ í€´ì¦ˆ</div>
  </div>

  <!-- â•â• ë²ˆì—­ íƒ­ â•â• -->
  <div class="panel active" id="panel-translate">
    <div class="input-row">
      <input type="text" id="wordInput"
             placeholder="ì˜ì–´ ë‹¨ì–´ ë˜ëŠ” ë¬¸ì¥ ì…ë ¥"
             onkeydown="handleKey(event)" />
      <button class="btn btn-blue" id="translateBtn" onclick="doTranslate()">ë²ˆì—­</button>
    </div>

    <div class="loading" id="loading">
      <span class="spinner"></span>ë²ˆì—­ ì¤‘...
    </div>

    <div class="result-card" id="resultCard">
      <div class="result-en"   id="resultEn"></div>
      <div class="result-ko"   id="resultKo"></div>
      <div class="result-meta" id="resultMeta"></div>
      <button class="btn btn-green" id="addBtn" onclick="addToVocab()">ë‹¨ì–´ì¥ì— ì¶”ê°€ +</button>
    </div>
  </div>

  <!-- â•â• ë‹¨ì–´ì¥ íƒ­ â•â• -->
  <div class="panel" id="panel-vocab">
    <div class="vocab-header">
      <span class="vocab-count" id="vocabCount">0ê°œ ë‹¨ì–´</span>
      <button class="btn btn-red btn-sm" onclick="clearAll()">ì „ì²´ ì‚­ì œ</button>
    </div>
    <div class="export-row">
      <button class="btn btn-blue btn-sm" onclick="exportCSV()">CSV ë‚´ë³´ë‚´ê¸°</button>
      <button class="btn btn-blue btn-sm" onclick="importCSV()">CSV ê°€ì ¸ì˜¤ê¸°</button>
      <input type="file" id="importFile" accept=".csv" style="display:none" onchange="handleImport(event)" />
    </div>
    <input class="search-box" id="searchBox" type="text"
           placeholder="ğŸ” ë‹¨ì–´ ê²€ìƒ‰..." oninput="renderVocab()" />
    <div id="vocabList"></div>
  </div>

  <!-- â•â• í€´ì¦ˆ íƒ­ â•â• -->
  <div class="panel" id="panel-quiz">
    <div id="quizArea"></div>
  </div>

  <div class="toast" id="toast"></div>

<script>
  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PWA
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('sw.js').catch(() => {});
  }

  let deferredInstall = null;
  window.addEventListener('beforeinstallprompt', e => {
    e.preventDefault();
    deferredInstall = e;
    document.getElementById('installBanner').style.display = 'flex';
  });
  window.addEventListener('appinstalled', () => {
    document.getElementById('installBanner').style.display = 'none';
  });

  function installApp() {
    if (!deferredInstall) return;
    deferredInstall.prompt();
    deferredInstall.userChoice.then(() => { deferredInstall = null; });
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     Tabs
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  function switchTab(tab) {
    const names = ['translate', 'vocab', 'quiz'];
    document.querySelectorAll('.tab').forEach((t, i) =>
      t.classList.toggle('active', names[i] === tab)
    );
    document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
    document.getElementById('panel-' + tab).classList.add('active');
    if (tab === 'vocab') renderVocab();
    if (tab === 'quiz')  initQuiz();
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     Translation
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  let curWord = '', curTrans = '', alreadyAdded = false;

  function handleKey(e) { if (e.key === 'Enter') doTranslate(); }

  async function doTranslate() {
    const raw = document.getElementById('wordInput').value.trim();
    if (!raw) return;

    curWord = raw;
    alreadyAdded = false;

    const btn     = document.getElementById('translateBtn');
    const loading = document.getElementById('loading');
    const card    = document.getElementById('resultCard');

    btn.disabled = true;
    loading.classList.add('show');
    card.classList.remove('show');

    try {
      const url  = `https://api.mymemory.translated.net/get?q=${encodeURIComponent(raw)}&langpair=en|ko`;
      const res  = await fetch(url);
      const data = await res.json();

      if (data.responseStatus === 200) {
        curTrans = data.responseData.translatedText;

        document.getElementById('resultEn').textContent = raw;
        document.getElementById('resultKo').textContent = curTrans;
        document.getElementById('resultMeta').textContent =
          `ì‹ ë¢°ë„ ${Math.round((data.responseData.match || 0) * 100)}%  Â·  MyMemory ë¬´ë£Œ API`;

        const exists = getVocab().some(v => v.word.toLowerCase() === raw.toLowerCase());
        const addBtn = document.getElementById('addBtn');
        addBtn.textContent = exists ? 'ì´ë¯¸ ì¶”ê°€ë¨ âœ“' : 'ë‹¨ì–´ì¥ì— ì¶”ê°€ +';
        addBtn.className   = 'btn btn-green' + (exists ? ' added' : '');
        alreadyAdded = exists;

        card.classList.add('show');
      } else {
        showToast('ë²ˆì—­ ì‹¤íŒ¨. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
      }
    } catch {
      showToast('ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    } finally {
      btn.disabled = false;
      loading.classList.remove('show');
    }
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     Vocabulary CRUD
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  function addToVocab() {
    if (alreadyAdded || !curWord) return;
    const vocab = getVocab();
    if (vocab.some(v => v.word.toLowerCase() === curWord.toLowerCase())) {
      showToast('ì´ë¯¸ ë‹¨ì–´ì¥ì— ìˆìŠµë‹ˆë‹¤.');
      return;
    }
    vocab.unshift({ word: curWord, translation: curTrans, date: today() });
    saveVocab(vocab);
    updateBadge();

    const addBtn = document.getElementById('addBtn');
    addBtn.textContent = 'ì¶”ê°€ë¨ âœ“';
    addBtn.className   = 'btn btn-green added';
    alreadyAdded = true;
    showToast(`"${curWord}" ë‹¨ì–´ì¥ì— ì¶”ê°€!`);
  }

  function deleteWord(idx) {
    const vocab = getVocab();
    const name  = vocab[idx].word;
    vocab.splice(idx, 1);
    saveVocab(vocab);
    renderVocab();
    updateBadge();
    showToast(`"${name}" ì‚­ì œë¨`);
  }

  function clearAll() {
    if (!getVocab().length) return;
    if (confirm('ë‹¨ì–´ì¥ì„ ì „ë¶€ ì‚­ì œí• ê¹Œìš”?')) {
      saveVocab([]);
      renderVocab();
      updateBadge();
      showToast('ë‹¨ì–´ì¥ì„ ë¹„ì› ìŠµë‹ˆë‹¤.');
    }
  }

  function renderVocab() {
    const query    = (document.getElementById('searchBox').value || '').toLowerCase();
    const allVocab = getVocab();
    const filtered = allVocab.filter(v =>
      v.word.toLowerCase().includes(query) || v.translation.includes(query)
    );

    document.getElementById('vocabCount').textContent =
      `${allVocab.length}ê°œ ë‹¨ì–´${query ? ` (ê²€ìƒ‰: ${filtered.length}ê°œ)` : ''}`;

    const list = document.getElementById('vocabList');
    if (!filtered.length) {
      list.innerHTML = `<div class="empty-msg">
        <span class="empty-icon">${query ? 'ğŸ”' : 'ğŸ“­'}</span>
        ${query ? 'ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.' : 'ì•„ì§ ì €ì¥ëœ ë‹¨ì–´ê°€ ì—†ì–´ìš”.<br>ë²ˆì—­ íƒ­ì—ì„œ ë‹¨ì–´ë¥¼ ì¶”ê°€í•´ë³´ì„¸ìš”!'}
      </div>`;
      return;
    }

    list.innerHTML = filtered.map(v => {
      const origIdx = allVocab.findIndex(x => x.word === v.word && x.date === v.date);
      return `
        <div class="word-item">
          <div class="word-info">
            <div class="word-en-item">${escHtml(v.word)}</div>
            <div class="word-ko-item">${escHtml(v.translation)}</div>
            <div class="word-date-item">${v.date}</div>
          </div>
          <div class="word-actions">
            <button class="btn btn-red btn-sm" onclick="deleteWord(${origIdx})">ì‚­ì œ</button>
          </div>
        </div>`;
    }).join('');
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     Export / Import CSV
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  function exportCSV() {
    const vocab = getVocab();
    if (!vocab.length) { showToast('ì €ì¥ëœ ë‹¨ì–´ê°€ ì—†ìŠµë‹ˆë‹¤.'); return; }
    const rows  = ['ë‹¨ì–´,ë²ˆì—­,ë‚ ì§œ', ...vocab.map(v => `"${v.word}","${v.translation}","${v.date}"`)];
    const blob  = new Blob(['\uFEFF' + rows.join('\n')], { type: 'text/csv;charset=utf-8;' });
    const a     = Object.assign(document.createElement('a'), {
      href: URL.createObjectURL(blob), download: 'ì˜ì–´ë‹¨ì–´ì¥.csv'
    });
    a.click();
    showToast('CSV íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ!');
  }

  function importCSV() { document.getElementById('importFile').click(); }

  function handleImport(e) {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = ev => {
      const lines = ev.target.result.replace(/^\uFEFF/, '').split('\n').slice(1);
      const vocab = getVocab();
      let added = 0;
      lines.forEach(line => {
        const cols = line.match(/"([^"]*)"/g);
        if (!cols || cols.length < 2) return;
        const word = cols[0].replace(/"/g, '').trim();
        const tr   = cols[1].replace(/"/g, '').trim();
        const date = cols[2] ? cols[2].replace(/"/g, '').trim() : today();
        if (!word || vocab.some(v => v.word.toLowerCase() === word.toLowerCase())) return;
        vocab.push({ word, translation: tr, date });
        added++;
      });
      saveVocab(vocab);
      renderVocab();
      updateBadge();
      showToast(`${added}ê°œ ë‹¨ì–´ ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ!`);
      e.target.value = '';
    };
    reader.readAsText(file, 'utf-8');
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     Quiz
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  let quizList = [], quizIdx = 0;

  function initQuiz() {
    const vocab = getVocab();
    if (!vocab.length) {
      document.getElementById('quizArea').innerHTML =
        `<div class="quiz-empty">ğŸ“š ë‹¨ì–´ì¥ì— ë‹¨ì–´ë¥¼ ë¨¼ì € ì¶”ê°€í•˜ì„¸ìš”!</div>`;
      return;
    }
    quizList = [...vocab].sort(() => Math.random() - 0.5);
    quizIdx  = 0;
    renderQuiz();
  }

  function renderQuiz() {
    if (quizIdx >= quizList.length) {
      document.getElementById('quizArea').innerHTML = `
        <div class="quiz-card">
          <div style="font-size:42px;margin-bottom:12px">ğŸ‰</div>
          <div style="font-size:17px;font-weight:800;margin-bottom:6px">í€´ì¦ˆ ì™„ë£Œ!</div>
          <div style="font-size:13px;color:#aaa;margin-bottom:20px">${quizList.length}ê°œ ë‹¨ì–´ë¥¼ ëª¨ë‘ í’€ì—ˆì–´ìš”</div>
          <button class="btn btn-blue" onclick="initQuiz()">ë‹¤ì‹œ ì‹œì‘</button>
        </div>`;
      return;
    }

    const q    = quizList[quizIdx];
    const pct  = Math.round((quizIdx / quizList.length) * 100);
    document.getElementById('quizArea').innerHTML = `
      <div class="quiz-card">
        <div class="quiz-progress">${quizIdx + 1} / ${quizList.length}</div>
        <div class="quiz-progress-bar">
          <div class="quiz-progress-fill" style="width:${pct}%"></div>
        </div>
        <div class="quiz-word">${escHtml(q.word)}</div>
        <div class="quiz-hint">ì´ ë‹¨ì–´ì˜ ëœ»ì€ ë¬´ì—‡ì¼ê¹Œìš”?</div>
        <div class="quiz-answer" id="quizAnswer">${escHtml(q.translation)}</div>
        <div class="quiz-btns">
          <button class="btn btn-blue"  id="revealBtn" onclick="revealAnswer()">ì •ë‹µ ë³´ê¸°</button>
          <button class="btn btn-green" id="nextBtn"   onclick="nextQuiz()" style="display:none">ë‹¤ìŒ â†’</button>
        </div>
      </div>`;
  }

  function revealAnswer() {
    document.getElementById('quizAnswer').classList.add('show');
    document.getElementById('revealBtn').style.display = 'none';
    document.getElementById('nextBtn').style.display   = 'inline-block';
  }

  function nextQuiz() { quizIdx++; renderQuiz(); }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     Helpers
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  function getVocab()   { return JSON.parse(localStorage.getItem('vocab_en') || '[]'); }
  function saveVocab(v) { localStorage.setItem('vocab_en', JSON.stringify(v)); }
  function today()      { return new Date().toLocaleDateString('ko-KR'); }
  function escHtml(s)   { return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }

  function updateBadge() {
    const n = getVocab().length;
    document.getElementById('badge').textContent = n ? ` (${n})` : '';
  }

  let toastTimer;
  function showToast(msg) {
    const t = document.getElementById('toast');
    t.textContent = msg;
    t.classList.add('show');
    clearTimeout(toastTimer);
    toastTimer = setTimeout(() => t.classList.remove('show'), 2200);
  }

  updateBadge();
</script>
</body>
</html>
